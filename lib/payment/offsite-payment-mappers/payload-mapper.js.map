{"version":3,"sources":["../../../src/payment/offsite-payment-mappers/payload-mapper.js"],"names":["PayloadMapper","addressMapper","create","customerMapper","metaMapper","paymentMethodIdMapper","storeMapper","data","authToken","order","paymentMethod","payload","amount","grandTotal","integerAmount","bc_auth_token","currency","gateway","mapToId","notify_url","callbackUrl","order_id","orderId","page_title","document","title","payment_method_id","id","reference_id","return_url","returnUrl","payment","mapToBillingAddress","mapToCustomer","mapToMeta","mapToShippingAddress","mapToStore"],"mappings":";;;;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;IAEqBA,a;;;;AACjB;;;6BAGgB;AACZ,UAAMC,gBAAgB,wBAAcC,MAAd,EAAtB;AACA,UAAMC,iBAAiB,yBAAeD,MAAf,EAAvB;AACA,UAAME,aAAa,qBAAWF,MAAX,EAAnB;AACA,UAAMG,wBAAwB,gCAAsBH,MAAtB,EAA9B;AACA,UAAMI,cAAc,sBAAYJ,MAAZ,EAApB;;AAEA,aAAO,IAAIF,aAAJ,CAAkBC,aAAlB,EAAiCE,cAAjC,EAAiDC,UAAjD,EAA6DC,qBAA7D,EAAoFC,WAApF,CAAP;AACH;;AAED;;;;;;;;;;;AAQA,yBAAYL,aAAZ,EAA2BE,cAA3B,EAA2CC,UAA3C,EAAuDC,qBAAvD,EAA8EC,WAA9E,EAA2F;AAAA;;AACvF;;;;AAIA,SAAKL,aAAL,GAAqBA,aAArB;;AAEA;;;;AAIA,SAAKE,cAAL,GAAsBA,cAAtB;;AAEA;;;;AAIA,SAAKC,UAAL,GAAkBA,UAAlB;;AAEA;;;;AAIA,SAAKC,qBAAL,GAA6BA,qBAA7B;;AAEA;;;;AAIA,SAAKC,WAAL,GAAmBA,WAAnB;AACH;;AAED;;;;;;;;iCAIaC,I,EAAM;AAAA,UACPC,SADO,GACuCD,IADvC,CACPC,SADO;AAAA,wBACuCD,IADvC,CACIE,KADJ;AAAA,UACIA,KADJ,+BACY,EADZ;AAAA,gCACuCF,IADvC,CACgBG,aADhB;AAAA,UACgBA,aADhB,uCACgC,EADhC;;;AAGf,UAAMC,UAAU,4BACZ;AACIC,gBAAQH,MAAMI,UAAN,GAAmBJ,MAAMI,UAAN,CAAiBC,aAApC,GAAoD,IADhE;AAEIC,uBAAeP,SAFnB;AAGIQ,kBAAUP,MAAMO,QAHpB;AAIIC,iBAAS,KAAKZ,qBAAL,CAA2Ba,OAA3B,CAAmCR,aAAnC,CAJb;AAKIS,oBAAYV,MAAMW,WALtB;AAMIC,kBAAUZ,MAAMa,OAAN,GAAgB,qBAASb,MAAMa,OAAf,CAAhB,GAA0C,IANxD;AAOIC,oBAAYC,SAASC,KAAT,GAAiBD,SAASC,KAA1B,GAAkC,IAPlD;AAQIC,2BAAmBhB,cAAciB,EARrC;AASIC,sBAAcnB,MAAMa,OAAN,GAAgB,qBAASb,MAAMa,OAAf,CAAhB,GAA0C,IAT5D;AAUIO,oBAAYnB,cAAcoB,SAAd,KAA4BrB,MAAMsB,OAAN,GAAgBtB,MAAMsB,OAAN,CAAcD,SAA9B,GAA0C,IAAtE;AAVhB,OADY,EAaZ,KAAK7B,aAAL,CAAmB+B,mBAAnB,CAAuCzB,IAAvC,CAbY,EAcZ,KAAKJ,cAAL,CAAoB8B,aAApB,CAAkC1B,IAAlC,CAdY,EAeZ,KAAKH,UAAL,CAAgB8B,SAAhB,CAA0B3B,IAA1B,CAfY,EAgBZ,KAAKN,aAAL,CAAmBkC,oBAAnB,CAAwC5B,IAAxC,CAhBY,EAiBZ,KAAKD,WAAL,CAAiB8B,UAAjB,CAA4B7B,IAA5B,CAjBY,CAAhB;;AAoBA,aAAO,oBAAQI,OAAR,CAAP;AACH;;;;;;kBAlFgBX,a","file":"payload-mapper.js","sourcesContent":["import objectAssign from 'object-assign';\nimport { omitNil, toString } from '../../common/utils';\nimport AddressMapper from './address-mapper';\nimport CustomerMapper from './customer-mapper';\nimport MetaMapper from './meta-mapper';\nimport PaymentMethodIdMapper from '../payment-method-mappers/payment-method-id-mapper';\nimport StoreMapper from './store-mapper';\n\nexport default class PayloadMapper {\n    /**\n     * @returns {PayloadMapper}\n     */\n    static create() {\n        const addressMapper = AddressMapper.create();\n        const customerMapper = CustomerMapper.create();\n        const metaMapper = MetaMapper.create();\n        const paymentMethodIdMapper = PaymentMethodIdMapper.create();\n        const storeMapper = StoreMapper.create();\n\n        return new PayloadMapper(addressMapper, customerMapper, metaMapper, paymentMethodIdMapper, storeMapper);\n    }\n\n    /**\n     * @param {AddressMapper} addressMapper\n     * @param {CustomerMapper} customerMapper\n     * @param {MetaMapper} metaMapper\n     * @param {PaymentMethodIdMapper} paymentMethodIdMapper\n     * @param {StoreMapper} storeMapper\n     * @returns {Object}\n     */\n    constructor(addressMapper, customerMapper, metaMapper, paymentMethodIdMapper, storeMapper) {\n        /**\n         * @private\n         * @type {AddressMapper}\n         */\n        this.addressMapper = addressMapper;\n\n        /**\n         * @private\n         * @type {CustomerMapper}\n         */\n        this.customerMapper = customerMapper;\n\n        /**\n         * @private\n         * @type {MetaMapper}\n         */\n        this.metaMapper = metaMapper;\n\n        /**\n         * @private\n         * @type {PaymentMethodIdMapper}\n         */\n        this.paymentMethodIdMapper = paymentMethodIdMapper;\n\n        /**\n         * @private\n         * @type {StoreMapper}\n         */\n        this.storeMapper = storeMapper;\n    }\n\n    /**\n     * @param {PaymentRequestData} data\n     * @returns {Object}\n     */\n    mapToPayload(data) {\n        const { authToken, order = {}, paymentMethod = {} } = data;\n\n        const payload = objectAssign(\n            {\n                amount: order.grandTotal ? order.grandTotal.integerAmount : null,\n                bc_auth_token: authToken,\n                currency: order.currency,\n                gateway: this.paymentMethodIdMapper.mapToId(paymentMethod),\n                notify_url: order.callbackUrl,\n                order_id: order.orderId ? toString(order.orderId) : null,\n                page_title: document.title ? document.title : null,\n                payment_method_id: paymentMethod.id,\n                reference_id: order.orderId ? toString(order.orderId) : null,\n                return_url: paymentMethod.returnUrl || (order.payment ? order.payment.returnUrl : null),\n            },\n            this.addressMapper.mapToBillingAddress(data),\n            this.customerMapper.mapToCustomer(data),\n            this.metaMapper.mapToMeta(data),\n            this.addressMapper.mapToShippingAddress(data),\n            this.storeMapper.mapToStore(data)\n        );\n\n        return omitNil(payload);\n    }\n}\n"]}